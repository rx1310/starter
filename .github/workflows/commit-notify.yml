name: commit-notify

on:
  push:
    branches:
      - main
      - develop
      - action/notify-discord

jobs:
  sendMessage:
    name: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ–º–º–∏—Ç–µ
    runs-on: ubuntu-latest
    steps:
      # - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–±—â. –≤ Telegram
      #   uses: appleboy/telegram-action@master
      #   with:
      #     to: ${{ secrets.TG_GROUP }}
      #     token: ${{ secrets.TG_BOT_TOKEN }}
      #     format: markdown
      #     message: |
      #       üëÄ –Ø –∑–∞–º–µ—Ç–∏–ª –∫–∞–∫–∏–µ-—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ [${{ github.repository }}](https://github.com/${{ github.repository }}) –æ—Ç [@${{ github.actor }}](https://github.com/${{ github.actor }})! –ü–æ—Å–ª. –∫–æ–º–º–∏—Ç –∫–æ—Ç–æ—Ä—ã–π –æ–Ω –¥–æ–±–∞–≤–∏–ª: ¬´${{ github.event.commits[0].message }}¬ª –∏ –µ–≥–æ —Ö–µ—à-—Å—É–º–º–∞: [${{github.sha}}](https://github.com/${{ github.repository }}/commit/${{github.sha}}).
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–±—â. –≤ Discord
        uses: Sniddl/discord-commits@v1.3
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK }}
          message: "üëÄ –Ø –∑–∞–º–µ—Ç–∏–ª –∫–∞–∫–∏–µ-—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ **{{ github.context.payload.repository.owner.name }}/{{ github.context.payload.repository.name}}** {{ title }}.\n\nüîó –°—Å—ã–ª–∫–∞ –Ω–∞ Diff: {{ github.context.payload.compare }}"
          embed: '{ "title": "{{ commit.title }}", "description": "{{ commit.description }}", "url": "{{ commit.url }}", "author": { "name": "{{ commit.author.name }} ({{ commit.author.username }})", "icon_url": "https://avatars.io/gravatar/{{ commit.author.email }}"} }'
          last-commit-only: false
